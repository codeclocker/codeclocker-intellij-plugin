<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
  <id>com.codeclocker</id>
  <name>CodeClocker Time Tracker</name>
  <vendor>AndrewPasika</vendor>

  <depends>com.intellij.modules.platform</depends>
  <depends optional="true" config-file="git-features.xml">Git4Idea</depends>

  <resource-bundle>messages.Bundle</resource-bundle>

  <extensions defaultExtensionNs="com.intellij">
    <errorHandler implementation="com.intellij.diagnostic.JetBrainsMarketplaceErrorReportSubmitter"/>

    <applicationService
      serviceImplementation="com.codeclocker.plugin.intellij.services.TimeSpentActivityTracker"/>
    <applicationService
      serviceImplementation="com.codeclocker.plugin.intellij.services.vcs.ChangesActivityTracker"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.subscription.CheckSubscriptionStateHttpClient"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.reporting.ActivitySampleHttpClient"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.apikey.ApiKeyLifecycle"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.config.ConfigProvider"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.NotificationService"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.config.PluginConfigHttpClient"/>
    <applicationService
      serviceImplementation="com.codeclocker.plugin.intellij.subscription.SubscriptionStateCheckerTask"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.reporting.DailyTimeHttpClient"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.services.TimeSpentPerProjectLogger"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.local.LocalStateRepository"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.analytics.AnalyticsHttpClient"/>
    <applicationService serviceImplementation="com.codeclocker.plugin.intellij.analytics.AnalyticsReportingTask"/>

    <projectService serviceImplementation="com.codeclocker.plugin.intellij.services.TimeTrackerWidgetService"/>

    <statusBarWidgetFactory
      id="com.codeclocker.TimeTrackerWidget"
      implementation="com.codeclocker.plugin.intellij.widget.TimeTrackerWidgetFactory"
      order="before largeFileEncodingWidget"/>

    <postStartupActivity implementation="com.codeclocker.plugin.intellij.ListenerRegistrator"/>
    <postStartupActivity implementation="com.codeclocker.plugin.intellij.onboarding.OnboardingStartupActivity"/>

    <notificationGroup id="CodeClocker" displayType="STICKY_BALLOON"/>

    <checkinHandlerFactory implementation="com.codeclocker.plugin.intellij.git.GitCommitStatsListener"/>

    <toolWindow id="CodeClocker Activity Report"
                factoryClass="com.codeclocker.plugin.intellij.toolwindow.BranchActivityToolWindowFactory"
                anchor="bottom"
                icon="/META-INF/statusBarWidgetIcon.svg"/>
  </extensions>

  <applicationListeners>
    <listener class="com.codeclocker.plugin.intellij.listeners.AppFrameFocusLostListener"
      topic="com.intellij.openapi.application.ApplicationActivationListener"/>
    <listener class="com.codeclocker.plugin.intellij.listeners.PauseProjectOnProjectClosing"
      topic="com.intellij.openapi.project.ProjectManagerListener"/>
  </applicationListeners>

  <actions>
    <action id="com.codeclocker.plugin.intellij.apikey.EnterApiKeyAction"
      class="com.codeclocker.plugin.intellij.apikey.EnterApiKeyAction"
      text="CodeClocker API Key"
      description="Enter codeClocker API key">
      <add-to-group group-id="ToolsMenu" anchor="first"/>
    </action>
    <action id="com.codeclocker.plugin.intellij.onboarding.RestartOnboardingAction"
      class="com.codeclocker.plugin.intellij.onboarding.RestartOnboardingAction"
      text="CodeClocker Tutorial"
      description="Restart the CodeClocker getting started tutorial">
      <add-to-group group-id="ToolsMenu" anchor="after"
        relative-to-action="com.codeclocker.plugin.intellij.apikey.EnterApiKeyAction"/>
    </action>
  </actions>
</idea-plugin>
